version: '3'

tasks:
  # Update gRPC protocol definitions
  protogen:
    dir: proto
    cmds:
      - |
        protoc \
        --go_out=../pkg/grpc/proto --go_opt=paths=source_relative \
        --go-grpc_out=../pkg/grpc/proto --go-grpc_opt=paths=source_relative \
        bmc.proto
      - |
        protoc \
        --go_out=../pkg/grpc/proto --go_opt=paths=source_relative \
        --go-grpc_out=../pkg/grpc/proto --go-grpc_opt=paths=source_relative \
        config.proto
    sources:
      - ./*.proto
    generates:
      - ./*.go
